## 계층형 아키텍처도 견고한 아키텍처다.

- 계층을 잘 이해하고 구성한다면, 웹/영속성 계층에 독립적으로 도메인 로직을 작성할 수 있다. (아마도 OCP/DI 겠지..)
- 구성을 잘한다면, 도메인 로직에 영향을 주지 않고, 외부 기술 계층의 변화가 가능하다

## 계층형 아키텍처는 데이터베이스 주도 설계를 유도한다.

- web ~> domain ~> *persistence(DB)* : 결론적으로 DB에 의존!
- 어플리케이션의 목적
  - 비즈니스의 규칙/정책을 반영한 모델 구현, 사용자가 활용
  - 상태가 아닌 *행동* 을 중심으로 모델링, 행동이 상태를 바꾼다
- 그러나 상태를 담은 DB 중심적으로 어플리케이션을 구성하게 된다

### 도메인 로직을 먼저 만들자

- 비즈니스 관점에선, 로직을 이해하고 구성한 후에 웹과 영속 계층을 만들어야한다

### ORM 사용에 따른 DB 중심적 설계

- ORM + 계층형 아키텍처 ~> 비즈니스 규칙을 영속성 관점과 섞고 싶은 유혹
- 도메인/영속간의 강결합 발생, 영속 모델을 비즈니스 모델처럼 사용하고, 도메인 로직 뿐만 아니라 영속 계층 작업도 수행
  - eager/lazy loading, transaction, flush 등
- 영속 코드가 사실상 도메인 코드에 녹아들어가서 둘 중 하나만 바꾸는 것이 어려워진다.

### UseCase(=Service) 를 찾기 어렵다

- 잘못된 계층에 코드 작성된 경우, 어디에 UseCase 가 존재하는지 찾기가 어렵다
- 도메인 로직이 여러 계층에 흩어지기 쉽다
- 넓은 서비스가 만들어지기도 한다
  - UserService VS *LoginUserService*
